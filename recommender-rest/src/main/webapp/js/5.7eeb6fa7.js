(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[5],{1837:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-badge",{staticClass:"col-auto",attrs:{color:"secondary","multi-line":""},on:{click:e.clicked}},[e._v("\n    "+e._s(e.name)+"\n")])},n=[],o={name:"MovieList",props:{id:{type:Number,required:!0},name:{type:String,required:!0}},methods:{clicked(){this.$q.notify({color:"positive",textColor:"white",icon:"cloud_done",message:"clicked"+JSON.stringify(this.id)})}}},r=o,s=a("2877"),l=a("58a81"),c=a("eebe"),d=a.n(c),m=Object(s["a"])(r,i,n,!1,null,null,null);t["a"]=m.exports;d()(m,"components",{QBadge:l["a"]})},"1f6b":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-page",[a("MovieDetail",{ref:"MovieDetail",attrs:{id:e.movie.id,name:e.movie.name,description:e.movie.description,yearMade:e.movie.yearMade,countryCode:e.movie.countryCode,lengthMin:e.movie.lengthMin,genres:e.movie.genres,actors:e.movie.actors,director:e.movie.director,ratingAgg:e.movie.ratingAgg,ratingUser:e.movie.ratingUser,imageTitle:e.movie._embedded.titleImage,imageGallery:e.movie._embedded.imageGallery._embedded.imageDetailDTOList,movie:e.movie}})],1)},n=[],o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"row full-height"},[a("div",{staticClass:"col-xs-12 col-sm-8 col-md-10 q-pa-sm"},[a("div",{staticClass:"row items-center justify-between"},[a("span",{staticClass:"col-auto text-h2"},[e._v("\n      "+e._s(e.name)+"\n      ")]),a("div",{staticClass:"col-auto"},[a("div",{staticClass:"justify-end"},[a("q-rating",{attrs:{icon:"star_border",readonly:"",size:"md","icon-selected":"star","icon-half":"star_half",max:10,color:"accent"},model:{value:e.ratingAgg,callback:function(t){e.ratingAgg=t},expression:"ratingAgg"}}),a("div",{staticClass:"text-caption q-mr-sm text-accent text-right text-weight-bold"},[e._v(e._s(e.ratingAgg))])],1)])]),a("q-responsive",{attrs:{ratio:4/3}},[a("q-carousel",{attrs:{fullscreen:e.fullscreen,animated:"",swipeable:"",thumbnails:"",padding:"",infinite:""},on:{"update:fullscreen":function(t){e.fullscreen=t}},scopedSlots:e._u([{key:"control",fn:function(){return[a("q-carousel-control",{attrs:{position:"bottom-right",offset:[18,18]}},[a("q-btn",{attrs:{push:"",round:"",dense:"",color:"white","text-color":"primary",icon:e.fullscreen?"fullscreen_exit":"fullscreen"},on:{click:function(t){e.fullscreen=!e.fullscreen}}})],1)]},proxy:!0}]),model:{value:e.currentImage,callback:function(t){e.currentImage=t},expression:"currentImage"}},e._l(e.imageGallery,(function(e){return a("q-carousel-slide",{key:e.id,attrs:{name:e.id,"img-src":e._links.self.href}})})),1)],1),a("div",{staticClass:"text-body1"},[e._v("\n      "+e._s(e.description)+"\n    ")])],1),a("div",{staticClass:"col-xs-12 col-sm-4 col-md-2 q-pa-sm"},[a("q-img",{attrs:{src:e.imageTitle._links.self.href,contain:""}}),a("div",{staticClass:"row justify-start items-baseline q-gutter-sm q-pt-lg"},e._l(e.genres,(function(e){return a("GenreBadge",{key:e.id,attrs:{id:e.id,name:e.name}})})),1),a("div",{staticClass:"text-subtitle1"},[a("span",{staticClass:"text-weight-bold"},[e._v("\n        Year of production: \n      ")]),e._v("\n      "+e._s(e.yearMadeSafe)+"\n    ")]),a("div",{staticClass:"text-subtitle1"},[a("span",{staticClass:"text-weight-bold"},[e._v("\n        Country of origin: \n      ")]),e._v("\n      "+e._s(e.countryCode)+"\n    ")]),a("div",{staticClass:"text-subtitle1"},[a("span",{staticClass:"text-weight-bold"},[e._v("\n        Director: \n      ")]),a("div",[e._v("\n        "+e._s(e.director.name)+"\n      ")])]),a("div",{staticClass:"text-subtitle1"},[a("div",{staticClass:"text-weight-bold"},[e._v("\n        Cast: \n      ")]),e._l(e.actors,(function(t){return a("div",{key:t.id},[e._v(" "+e._s(t.name)+" ")])}))],2),a("q-btn",{staticClass:"q-my-md",attrs:{color:"positive"},on:{click:function(t){return e.doRating()}}},[a("q-icon",{attrs:{left:"",size:"2em",name:e.ratingIcon}}),a("div",[e._v(e._s(e.ratingText))])],1),e.isAdmin?a("q-btn",{staticClass:"q-my-md",attrs:{color:"secondary"},on:{click:e.editAllText}},[a("q-icon",{attrs:{left:"",size:"2em",name:"edit"}}),a("div",[e._v("Edit text")])],1):e._e(),a("EditTextDialog",{attrs:{movie:e.movie},model:{value:e.edit_text_dialog,callback:function(t){e.edit_text_dialog=t},expression:"edit_text_dialog"}}),e.isAdmin?a("q-btn",{staticClass:"q-my-md",attrs:{color:"secondary"},on:{click:e.setTitleImage}},[a("q-icon",{attrs:{left:"",size:"2em",name:"image"}}),a("div",[e._v("Set title image")])],1):e._e(),a("ChangeTitleImageDialog",{attrs:{movie:e.movie},model:{value:e.change_title_dialog,callback:function(t){e.change_title_dialog=t},expression:"change_title_dialog"}}),e.isAdmin?a("q-btn",{staticClass:"q-my-md",attrs:{color:"secondary"},on:{click:e.addGalleryImage}},[a("q-icon",{attrs:{left:"",size:"2em",name:"collections"}}),a("div",[e._v("Add to gallery")])],1):e._e(),a("AddImageDialog",{attrs:{movie:e.movie},model:{value:e.add_gallery_dialog,callback:function(t){e.add_gallery_dialog=t},expression:"add_gallery_dialog"}})],1),a("q-dialog",{model:{value:e.ratingDialog,callback:function(t){e.ratingDialog=t},expression:"ratingDialog"}},[a("q-card",{staticClass:"q-px-sm q-pb-md",staticStyle:{width:"300px"}},[a("q-card-section",[a("div",{staticClass:"text-h6"},[e._v("Your rating")])]),a("q-item-label",{attrs:{header:""}},[e._v("Story score")]),a("q-item",{attrs:{dense:""}},[a("q-item-section",{attrs:{avatar:""}},[a("q-icon",{attrs:{name:"auto_stories"}})],1),a("q-item-section",[a("q-slider",{attrs:{"label-always":"",color:"teal",step:1,min:0,max:10},model:{value:e.ratingUserSafe.storyScore,callback:function(t){e.$set(e.ratingUserSafe,"storyScore",t)},expression:"ratingUserSafe.storyScore"}})],1)],1),a("q-item-label",{attrs:{header:""}},[e._v("Visual score")]),a("q-item",{attrs:{dense:""}},[a("q-item-section",{attrs:{avatar:""}},[a("q-icon",{attrs:{name:"videocam"}})],1),a("q-item-section",[a("q-slider",{attrs:{"label-always":"",color:"teal",step:1,min:0,max:10},model:{value:e.ratingUserSafe.visualScore,callback:function(t){e.$set(e.ratingUserSafe,"visualScore",t)},expression:"ratingUserSafe.visualScore"}})],1)],1),a("q-item-label",{attrs:{header:""}},[e._v("Actor score")]),a("q-item",{attrs:{dense:""}},[a("q-item-section",{attrs:{avatar:""}},[a("q-icon",{attrs:{name:"group"}})],1),a("q-item-section",[a("q-slider",{attrs:{"label-always":"",color:"teal",step:1,min:0,max:10},model:{value:e.ratingUserSafe.actorScore,callback:function(t){e.$set(e.ratingUserSafe,"actorScore",t)},expression:"ratingUserSafe.actorScore"}})],1)],1),a("q-item-label",{attrs:{header:""}},[e._v("Overall score")]),a("q-btn",{staticClass:"q-mx-auto",attrs:{color:"positive"},on:{click:function(t){return e.submitRating()}}},[a("q-icon",{attrs:{left:"",size:"2em",name:"send"}}),a("div",[e._v("Submit")])],1)],1)],1)],1)},r=[],s=a("1837"),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div")},c=[],d={components:{GenreBadge:s["a"]},name:"MovieDetail",created:function(){this.ratingUser?(this.ratingText="Edit rating!",this.ratingIcon="edit"):(this.ratingText="Add rating!",this.ratingIcon="thumbs_up_down")},data(){return{visible:!0}},props:{id:{type:Number,required:!0},storyScore:{type:Number,required:!0},visualScore:{type:Number,required:!0},actorScore:{type:Number,required:!0},overallScore:{type:Number,required:!0}}},m=d,u=a("2877"),g=Object(u["a"])(m,l,c,!1,null,null,null),p=g.exports,v=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-dialog",{attrs:{value:e.value},on:{input:function(t){return e.$emit("input",t)}}},[a("q-card",{staticStyle:{"min-width":"350px"}},[a("q-form",{on:{submit:function(t){return e.submitVal(e.movieCopy)}}},[a("q-card-section",[a("q-input",{attrs:{filled:"",label:"Name",rules:[function(e){return e&&e.length>0||"Please type something"},function(e){return e&&e.length<50||"Can not be more than 50 chars"}]},model:{value:e.movieCopy.name,callback:function(t){e.$set(e.movieCopy,"name",t)},expression:"movieCopy.name"}})],1),a("q-card-section",[a("q-input",{attrs:{filled:"",autogrow:"",label:"Description","lazy-rules":"",rules:[function(e){return e&&e.length>0||"Please type something"},function(e){return e&&e.length<255||"Can not be more than 255 chars"}]},model:{value:e.movieCopy.description,callback:function(t){e.$set(e.movieCopy,"description",t)},expression:"movieCopy.description"}})],1),a("q-card-section",{staticClass:"column justify-center"},[a("q-date",{attrs:{"emit-immediately":!0,mask:"YYYY-MM-DD","default-view":"Years",options:e.notFutureYear,"navigation-max-year-month":e.max_year_month},model:{value:e.movieCopy.yearMade,callback:function(t){e.$set(e.movieCopy,"yearMade",t)},expression:"movieCopy.yearMade"}}),a("q-badge",{attrs:{color:"teal"}},[e._v("\n            Only year choice is supported: "+e._s(e.movieCopy.yearMade)+"\n          ")])],1),a("q-card-section",[a("q-input",{attrs:{filled:"",label:"Country code","lazy-rules":"",rules:[function(e){return e.length<=3||"Please use maximum 3 characters"},function(e){return/^[A-Z]+$/.test(e)||"Must contain only capital letters"}]},model:{value:e.movieCopy.countryCode,callback:function(t){e.$set(e.movieCopy,"countryCode",t)},expression:"movieCopy.countryCode"}})],1),a("q-card-section",[a("q-input",{attrs:{filled:"",type:"number","lazy-rules":"",label:"Length min"},model:{value:e.movieCopy.lengthMin,callback:function(t){e.$set(e.movieCopy,"lengthMin",t)},expression:"movieCopy.lengthMin"}})],1),a("q-card-actions",{staticClass:"text-primary",attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Cancel",color:"negative"}}),a("q-btn",{attrs:{flat:"",label:"Submit",type:"submit",color:"positive"}})],1)],1)],1)],1)},f=[],h=(a("5319"),a("bf19"),a("e01a"),a("1069")),y={name:"EditTextDialog",props:{value:{},movie:{type:Object,required:!0}},data(){return{movieCopy:JSON.parse(JSON.stringify(this.movie))}},computed:{max_year_month:function(){return(new Date).toJSON().slice(0,7).replace(/-/g,"/")}},methods:{submitVal(e){var t=new Date(e.yearMade).getFullYear();e.yearMade=t+"-01-01";var a={id:e.id,name:e.name,description:e.description,yearMade:e.yearMade,countryCode:e.countryCode,lengthMin:e.lengthMin};this.$axios.put("/movies/"+e.id,a).then((t=>{h["a"].notifyPosit("sent update: "+JSON.stringify(a,null,1)),this.$router.push("/movies/"+e.id)})).catch((e=>{h["a"].notifyNegatResp(e)}))},notFutureYear(){return new Date(this.movieCopy.yearMade)<=new Date}},watch:{value:function(){this.movieCopy=JSON.parse(JSON.stringify(this.movie))}}},b=y,_=a("24e8"),q=a("f09f"),x=a("0378"),C=a("a370"),S=a("27f9"),I=a("52ee"),k=a("58a81"),M=a("4b7e"),D=a("9c40"),w=a("7f67"),Q=a("eebe"),$=a.n(Q),A=Object(u["a"])(b,v,f,!1,null,null,null),j=A.exports;$()(A,"components",{QDialog:_["a"],QCard:q["a"],QForm:x["a"],QCardSection:C["a"],QInput:S["a"],QDate:I["a"],QBadge:k["a"],QCardActions:M["a"],QBtn:D["a"]}),$()(A,"directives",{ClosePopup:w["a"]});var O=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-dialog",{staticStyle:{"{min-height":"400px","max-width":"300px}"},attrs:{value:e.value},on:{input:function(t){return e.$emit("input",t)}}},[a("q-card",{staticStyle:{"min-width":"300px"}},[a("q-card-section",[a("span",{staticClass:"text-h3"},[e._v("\n         Add images to gallery:\n       ")])]),a("q-file",{attrs:{filled:"",label:"Set title image",accept:".jpg, image/*"},on:{rejected:e.onRejected},scopedSlots:e._u([{key:"prepend",fn:function(){return[a("q-icon",{attrs:{name:"image"}})]},proxy:!0},{key:"after",fn:function(){return[a("q-btn",{attrs:{round:"",dense:"",flat:"",icon:"send",color:"positive"},on:{click:e.sendTitleImage}})]},proxy:!0}]),model:{value:e.filesImages,callback:function(t){e.filesImages=t},expression:"filesImages"}})],1)],1)},T=[];function N(e){return new Promise(((t,a)=>{const i=new FileReader;i.readAsDataURL(e),i.onload=()=>t(/base64,(.+)/.exec(i.result)[1]),i.onerror=e=>a(e)}))}var U={name:"AddImageDialog",data(){return{filesImages:null}},methods:{addMovieId:function(){return[{movieId:this.movie.id}]},sendTitleImage(){console.log(this.filesImages),N(this.filesImages).then((e=>{console.log("base64 conv: ",e);var t={movieId:this.movie.id,image:e,imageMimeType:this.filesImages.type};this.$axios.post("/movies/addimage",t).then((e=>{console.log("image response: ",JSON.stringify(e,null,1))})).catch((e=>{console.log("image error: ",JSON.stringify(e,null,1))}))})).catch((e=>{this.$q.notify({color:"negative",icon:"error",message:"Failed to convert file..."})}))},onRejected(e){this.$q.notify({type:"negative",message:`${e.length} file(s) did not pass validation constraints`})}},props:{value:{},movie:{type:Object,required:!0}}},J=U,R=a("7d53"),E=a("0016"),Y=a("ee89"),G=Object(u["a"])(J,O,T,!1,null,null,null),B=G.exports;$()(G,"components",{QDialog:_["a"],QCard:q["a"],QCardSection:C["a"],QFile:R["a"],QIcon:E["a"],QBtn:D["a"],QUploader:Y["a"]});var z=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-dialog",{staticStyle:{"{min-height":"400px","max-width":"300px}"},attrs:{value:e.value},on:{input:function(t){return e.$emit("input",t)}}},[a("q-card",{staticStyle:{"min-width":"300px"}},[a("q-card-section",[a("span",{staticClass:"text-h3"},[e._v("\n        Set title image:\n      ")])]),a("q-file",{attrs:{filled:"",label:"Set title image",accept:".jpg, image/*"},on:{rejected:e.onRejected},scopedSlots:e._u([{key:"prepend",fn:function(){return[a("q-icon",{attrs:{name:"image"}})]},proxy:!0},{key:"after",fn:function(){return[a("q-btn",{attrs:{round:"",dense:"",flat:"",icon:"send",color:"positive"},on:{click:e.sendTitleImage}})]},proxy:!0}]),model:{value:e.filesImages,callback:function(t){e.filesImages=t},expression:"filesImages"}})],1)],1)},F=[],P={name:"ChangeTitleImageDialog",data(){return{filesImages:null}},methods:{addMovieId:function(){return[{movieId:this.movie.id}]},sendTitleImage(){console.log(this.filesImages),N(this.filesImages).then((e=>{console.log("base64 conv: ",e);var t={movieId:this.movie.id,image:e,imageMimeType:this.filesImages.type};this.$axios.put("/movies/changetitle",t).then((e=>{console.log("image response: ",JSON.stringify(e,null,1))})).catch((e=>{console.log("image error: ",JSON.stringify(e,null,1))}))})).catch((e=>{this.$q.notify({color:"negative",icon:"error",message:"Failed to convert file..."})}))},onRejected(e){this.$q.notify({type:"negative",message:`${e.length} file(s) did not pass validation constraints`})}},props:{value:{},movie:{type:Object,required:!0}}},L=P,V=Object(u["a"])(L,z,F,!1,null,null,null),K=V.exports;$()(V,"components",{QDialog:_["a"],QCard:q["a"],QCardSection:C["a"],QFile:R["a"],QIcon:E["a"],QBtn:D["a"],QUploader:Y["a"]});var Z={components:{GenreBadge:s["a"],RatingDialog:p,EditTextDialog:j,AddImageDialog:B,ChangeTitleImageDialog:K,ChangeTitleImageDialog:K},name:"MovieDetail",created:function(){console.log(" created!"),this.ratingUser?(this.ratingText="Edit rating!",this.ratingIcon="edit"):(this.ratingText="Add rating!",this.ratingIcon="thumbs_up_down")},data(){return{currentImage:1,fullscreen:!1,ratingIcon:"thumbs_up_down",ratingText:"Add rating!",ratingDialog:!1,edit_text_dialog:!1,change_title_dialog:!1,add_gallery_dialog:!1}},computed:{ratingUserSafe:function(){return this.ratingUser?this.ratingUser:{storyScore:5,actorScore:5,visualScore:5}},isAdmin:function(){var e=this.$store.getters["auth/user"];return console.log(e),!!e&&e.isAdmin},yearMadeSafe:function(){if(console.log(this.yearMade),this.yearMade)return console.log(this.yearMade),this.yearMade.substr(0,4)}},props:{id:{type:Number,required:!0},name:{type:String,required:!0},description:{type:String,required:!0},imageTitle:{type:Object,required:!0},imageGallery:{type:Array,required:!0},yearMade:{type:Number},countryCode:{type:String},lengthMin:{type:Number},genres:{type:Array,required:!1},actors:{type:Array},director:{type:Object},ratingAgg:{type:Number,required:!1},ratingUser:{type:Object,required:!1},movie:{type:Object,required:!0}},methods:{doRating(){this.ratingDialog=!this.ratingDialog},submitRating(){this.$q.notify({color:"positive",textColor:"white",icon:"cloud_done",message:"Your rating is saved 👍"})},editAllText(){this.edit_text_dialog=!0},setTitleImage(){this.change_title_dialog=!0},addGalleryImage(){this.add_gallery_dialog=!0}},watch:{imageGallery:function(){this.currentImage=this.imageGallery[0].id}}},W=Z,H=a("daf4"),X=a("0e51"),ee=a("880c"),te=a("62cd"),ae=a("32a7"),ie=a("068f"),ne=a("0170"),oe=a("66e5"),re=a("4074"),se=a("c1d0"),le=Object(u["a"])(W,o,r,!1,null,null,null),ce=le.exports;$()(le,"components",{QRating:H["a"],QResponsive:X["a"],QCarousel:ee["a"],QCarouselSlide:te["a"],QCarouselControl:ae["a"],QBtn:D["a"],QImg:ie["a"],QIcon:E["a"],QDialog:_["a"],QCard:q["a"],QCardSection:C["a"],QItemLabel:ne["a"],QItem:oe["a"],QItemSection:re["a"],QSlider:se["a"]});var de={name:"PageIndex",components:{MovieDetail:ce,GenreBadge:s["a"]},created:function(){let e=this.$router.currentRoute.params.id;this.$q.loading.show(),this.$axios.get("/movies/"+e).then((e=>{this.movie=e.data,this.links=e.data._links,console.log("got response!"),this.$q.loading.hide()})).catch((e=>{console.error(e),this.$q.loading.hide(),this.$q.notify({color:"negative",position:"top",message:"Loading failed",icon:"report_problem"})}))},data(){return{currentImage:1,links:null,movie:null,fullscreen:!1,exampleMovie:{id:2,name:"Aaj-Kalova pomsta",description:"Tento film je o tom ako Spidermanov život pokračuje, ale do cesty sa mu postaví Aaj Kal, postrach Indie.",yearMade:{year:1995,month:"JANUARY",monthValue:1,dayOfMonth:1,dayOfYear:1,chronology:{id:"ISO",calendarType:"iso8601"},dayOfWeek:"SUNDAY",era:"CE",leapYear:!1},countryCode:"USA",lengthMin:150,genres:[{id:2,name:"romantic"},{id:3,name:"animated"}],actors:[{id:3,name:"Eminem Zamlada"},{id:6,name:"Daniel Dangl"},{id:4,name:"Dr. Dre"},{id:5,name:"Jožko Vajda"}],director:{id:2,name:"Jana Kratochvilova"},ratingAgg:null,ratingUser:null,_embedded:{titleImage:{id:2,image:"binarny string",imageMimeType:"image/jpeg",_links:{self:{href:"http://localhost:8080/pa165/api/v1/images/url/2"}}},imageGallery:{_embedded:{imageDetailDTOList:[{id:7,image:"binarny string",imageMimeType:"image/jpeg",_links:{self:{href:"http://localhost:8080/pa165/api/v1/images/url/7"}}},{id:8,image:"binarny string",imageMimeType:"image/jpeg",_links:{self:{href:"http://localhost:8080/pa165/api/v1/images/url/8"}}}]}}},_links:{self:{href:"http://localhost:8080/pa165/api/v1/movies/2"},browse:{href:"http://localhost:8080/pa165/api/v1/movies"}}}}}},me=de,ue=(a("8b07"),a("9989")),ge=Object(u["a"])(me,i,n,!1,null,"78b21af0",null);t["default"]=ge.exports;$()(ge,"components",{QPage:ue["a"]})},"7b76":function(e,t,a){},"8b07":function(e,t,a){"use strict";a("7b76")}}]);